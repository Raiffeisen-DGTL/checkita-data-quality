
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="https://raiffeisen-dgtl.github.io/checkita-data-quality/03-job-configuration/09-Checks/" rel="canonical"/>
<link href="../08-Metrics/" rel="prev"/>
<link href="../10-Targets/" rel="next"/>
<link href="../../logo/favicon.png" rel="icon"/>
<meta content="mkdocs-1.6.0, mkdocs-material-9.5.27" name="generator"/>
<title>Checks Configurations - Checkita Data Quality</title>
<link href="../../assets/stylesheets/main.6543a935.min.css" rel="stylesheet"/>
<link href="../../assets/stylesheets/palette.06af60db.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
</head>
<body data-md-color-accent="indigo" data-md-color-primary="yellow" data-md-color-scheme="slate" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#checks-configurations">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="Checkita Data Quality" class="md-header__button md-logo" data-md-component="logo" href="../.." title="Checkita Data Quality">
<img alt="logo" src="../../logo/logo.png"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            Checkita Data Quality
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Checks Configurations
            
          </span>
</div>
</div>
</div>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="" tabindex="0">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/Raiffeisen-DGTL/checkita-data-quality" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    checkita-data-quality
  </div>
</a>
</div>
</nav>
<nav aria-label="Tabs" class="md-tabs" data-md-component="tabs">
<div class="md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="../..">
        
  
    
  
  Home

      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../01-application-setup/">
          
  
    
  
  Application Setup

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../02-general-information/">
          
  
    
  
  General Information

        </a>
</li>
<li class="md-tabs__item md-tabs__item--active">
<a class="md-tabs__link" href="../">
          
  
    
  
  Job Configuration

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../changelog/CHANGELOG/">
        
  
    
  
  Changelog

      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../contribution/">
          
  
    
  
  Contribution

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../api/">
        
  
    
  
  Scala API Doc

      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../swagger/">
        
  
    
  
  Swagger Doc

      </a>
</li>
</ul>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Checkita Data Quality" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="Checkita Data Quality">
<img alt="logo" src="../../logo/logo.png"/>
</a>
    Checkita Data Quality
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/Raiffeisen-DGTL/checkita-data-quality" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    checkita-data-quality
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../..">
<span class="md-ellipsis">
    Home
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../01-application-setup/">
<span class="md-ellipsis">
    Application Setup
  </span>
</a>
<label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
            Application Setup
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../01-application-setup/01-ApplicationSettings/">
<span class="md-ellipsis">
    Application Settings
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../01-application-setup/02-ApplicationSubmit/">
<span class="md-ellipsis">
    Submitting Data Quality Application
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../01-application-setup/03-ResultsStorage/">
<span class="md-ellipsis">
    Data Quality Results Storage
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../02-general-information/">
<span class="md-ellipsis">
    General Information
  </span>
</a>
<label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_3_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
            General Information
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../02-general-information/01-WorkingWithDateTime/">
<span class="md-ellipsis">
    Working with Date and Time
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../02-general-information/02-EnvironmentAndExtraVariables/">
<span class="md-ellipsis">
    Usage of Environment Variables and Extra Variables
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../02-general-information/03-StatusModel/">
<span class="md-ellipsis">
    Status Model used in Results
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../02-general-information/04-ErrorCollection/">
<span class="md-ellipsis">
    Metric Error Collection
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../02-general-information/05-StreamingMode/">
<span class="md-ellipsis">
    Data Quality Checks over Streaming Sources
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../02-general-information/06-MetricSQLEquivalency/">
<span class="md-ellipsis">
    Metrics SQL Equivalency
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../02-general-information/07-MetricCalculatorEngines/">
<span class="md-ellipsis">
    Metric Calculator Engines Overview and Benchmarking
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_4" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../">
<span class="md-ellipsis">
    Job Configuration
  </span>
</a>
<label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="true" aria-labelledby="__nav_4_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
            Job Configuration
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../01-Connections/">
<span class="md-ellipsis">
    Connections Configuration
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../02-Schemas/">
<span class="md-ellipsis">
    Schemas Configuration
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../03-Sources/">
<span class="md-ellipsis">
    Sources Configuration
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../04-Streams/">
<span class="md-ellipsis">
    Streaming Sources Configurations
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../05-VirtualSources/">
<span class="md-ellipsis">
    Virtual Sources Configuration
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../06-VirtualStreams/">
<span class="md-ellipsis">
    Virtual Streaming Sources Configuration
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../07-LoadChecks/">
<span class="md-ellipsis">
    Load Checks Configuration
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../08-Metrics/">
<span class="md-ellipsis">
    Metrics Configuration
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
    Checks Configurations
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
<span class="md-ellipsis">
    Checks Configurations
  </span>
</a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#snapshot-checks">
<span class="md-ellipsis">
      Snapshot Checks
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#trend-checks">
<span class="md-ellipsis">
      Trend Checks
    </span>
</a>
<nav aria-label="Trend Checks" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#top-n-rank-check">
<span class="md-ellipsis">
      Top N Rank Check
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#expression-checks">
<span class="md-ellipsis">
      Expression Checks
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#checks-configuration-example">
<span class="md-ellipsis">
      Checks Configuration Example
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../10-Targets/">
<span class="md-ellipsis">
    Targets Configuration
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../11-FileOutputs/">
<span class="md-ellipsis">
    File Output Configuration
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../12-JobConfigExample/">
<span class="md-ellipsis">
    Job Configuration Example
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../changelog/CHANGELOG/">
<span class="md-ellipsis">
    Changelog
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_6" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../contribution/">
<span class="md-ellipsis">
    Contribution
  </span>
</a>
<label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_6_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_6">
<span class="md-nav__icon md-icon"></span>
            Contribution
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../contribution/code-of-conduct/">
<span class="md-ellipsis">
    Code of Conduct
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../contribution/contribution/">
<span class="md-ellipsis">
    Contribution Guide
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../api/">
<span class="md-ellipsis">
    Scala API Doc
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../swagger/">
<span class="md-ellipsis">
    Swagger Doc
  </span>
</a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1 id="checks-configurations">Checks Configurations</h1>
<p>Performing checks ove the metric results is an important step in Checkita framework. As metric results are calculated
then checks can be configured to identify if there are any problems with quality of data.</p>
<p>In Checkita there are two main group of checks:</p>
<ul>
<li><code>Spanshot</code> checks - allows comparison of metric results with static thresholds or with other metric results in the 
  same Data Quality job.</li>
<li><code>Trend</code> checks - allows evaluation of how metric result is changing over a certain period of time. Checks of this type
  are used to detect anomalies in data. In order trend check work it is required to set up Data Quality storage since
  check calculator need to fetch historical results for the metric of interest.</li>
<li><code>Expression</code> checks - allows to define boolean expression (formula) which can refer to multiple metric results.
  Check status is set depending on boolean expression evaluation result.</li>
</ul>
<blockquote>
<p><strong>IMPORTANT</strong>: Trend checks are scheduled for deprecation in Checkita 3.0 release as their functionality is now
covered (and also enhanced) by trend metrics.</p>
</blockquote>
<p>After evaluation, check will have a status as described in 
<a href="../../02-general-information/03-StatusModel/">Status Model used in Results</a> chapter. </p>
<h2 id="snapshot-checks">Snapshot Checks</h2>
<p>Snapshot checks represent a simple comparison of metric results with a static threshold or with other metric result.</p>
<p>The following snapshot checks are supported:</p>
<ul>
<li><code>equalTo</code> - checks if metric results is equal to a given threshold value or to other metric result.</li>
<li><code>lessThan</code> - checks if metric result is less than a given threshold value or other metric result.</li>
<li><code>greaterThan</code> - checks if metric result is greater than a given threshold value or other metric result.</li>
<li><code>differByLT</code> - checks if relative difference between <strong><em>two metric results</em></strong> is less than a given threshold.
  This check succeeds when following expression is true: <code>| metric - compareMetric | / compareMetric &lt; threshold</code>.</li>
</ul>
<p>Snapshot checks are configured using common set of parameters, which are:</p>
<ul>
<li><code>id</code> - <em>Required</em>. Check ID</li>
<li><code>description</code> - <em>Optional</em>. Description of the check.</li>
<li><code>metric</code> - <em>Required</em>. Metric ID which results is checked.</li>
<li><code>compareMetric</code> - <em>Optional</em>. Metric ID which result is used as a threshold.</li>
<li><code>threshold</code> - <em>Optional</em>. Explicit threshold value.</li>
<li><code>metadata</code> - <em>Optional</em>. List of user-defined metadata parameters specific to this check where each parameter
  is a string in format: <code>param.name=param.value</code>.</li>
</ul>
<blockquote>
<p><strong>IMPORTANT</strong>. When configuring check it should be specified either an explicit threshold value in <code>threshold</code> field
or other metric ID in <code>compareMetric</code> field which result will be used as a threshold value.
The only exception to this rule is <code>differByLY</code> check for which it is required to specify both, threshold value and
metric ID to compare with.</p>
</blockquote>
<h2 id="trend-checks">Trend Checks</h2>
<p>Trend checks are used to detect anomalies in data. This type of checks allows to verify that the value of the metric 
corresponds to its average value within a given deviation for a certain period of time. Maximum allowed deviation is 
configured by providing a threshold value.</p>
<p>Following trend checks are supported:</p>
<ul>
<li><code>averageBoundFull</code> - sets the same upper and lower deviation from metric average result. Check succeeds when following
  expression is true: <code>(1 - threshold) * avgResult &lt;= currentResult &lt;= (1 + threshold) * avgResult</code>.</li>
<li><code>averageBoundUpper</code> - verifies only upper deviation from the metric average result. Check succeeds when following
  expression is true: <code>currentResult &lt;= (1 + threshold) * avgResult</code>.</li>
<li><code>averageBoundLower</code> - verifies only lower deviation from the metric average result. Check succeeds when following
  expression is ture: <code>(1 - threshold) * avgResult &lt;= currentResult</code>.</li>
<li><code>averageBoundRange</code> - sets different thresholds for upper and lower deviations from metric average results.
  Check succeeds when following expression is true:
  <code>(1 - thresholdLower) * avgResult &lt;= currentResult &lt;= (1 + thresholdUpper) * avgResult</code>.</li>
</ul>
<p>Trend checks are configured using following set of parameters:</p>
<ul>
<li><code>id</code> - <em>Required</em>. Check ID</li>
<li><code>description</code> - <em>Optional</em>. Description of the check.</li>
<li><code>metric</code> - <em>Required</em>. Metric ID which result is checked.</li>
<li><code>rule</code> - <em>Required</em>. The rule for calculating historical average value of the metric. There are two rules supported:<ul>
<li><code>record</code> - calculates the average value of metric for the configured number of historical records.</li>
<li><code>datetime</code> - calculates the average value of metric for the configured datetime window.</li>
</ul>
</li>
<li><code>windowSize</code> - <em>Required</em>. Size of the window for average metric value calculation:<ul>
<li>If <code>rule</code> is set to <code>record</code> then window size is the number of records to retrieve.</li>
<li>If <code>rule</code> is set to <code>datetime</code> then window size is a duration string which should conform to Scala Duration.</li>
</ul>
</li>
<li><code>windowOffset</code> - <em>Optional, default is <code>0</code> or <code>0s</code></em>. Set window offset back from current reference date
  (see <a href="../../02-general-information/01-WorkingWithDateTime/">Working with Date and Time</a> chapter for more details on 
  reference date). By default, offset is absent and window start from current reference date.<ul>
<li>If <code>rule</code> is set to <code>record</code> then window offset is the number of records to skip from reference date.</li>
<li>If <code>rule</code> is set to <code>datetime</code> then window offset is a duration string which should conform to Scala Duration.</li>
</ul>
</li>
<li><code>threshold</code> - <em>Required</em>. Sets maximum allowed deviation from historical average metric result. <em>Not used with
  <code>averageBoundRange</code> check</em>.</li>
<li><code>thresholdLower</code> - <em>Required</em>. Sets maximum allowed lower deviation from historical average metric result. *Used only
  for <code>averageBoundRange</code> check.</li>
<li><code>thresholdUpper</code> - <em>Required</em>. Sets maximum allowed upper deviation from historical average metric result. *Used only
  for <code>averageBoundRange</code> check.</li>
<li><code>metadata</code> - <em>Optional</em>. List of user-defined metadata parameters specific to this metric where each parameter
  is a string in format: <code>param.name=param.value</code>.</li>
</ul>
<blockquote>
<p><strong>NOTE</strong>. Scala Duration string has a format of <code>&lt;length&gt;&lt;unit&gt;</code> where following units are allowed:
<code>d</code>, <code>day</code>, <code>h</code>, <code>hr</code>, <code>hour</code>, <code>m</code>, <code>min</code>, <code>minute</code>, <code>s</code>, <code>sec</code>, <code>second</code>, <code>ms</code>, <code>milli</code>, <code>millisecond</code>,
<code>µs</code>, <code>micro</code>, <code>microsecond</code>, <code>ns</code>, <code>nano</code>, <code>nanosecond</code>.</p>
</blockquote>
<h3 id="top-n-rank-check">Top N Rank Check</h3>
<p>This is a special check designed specifically for <a href="../08-Metrics/#top-n-metric">Top N Metric</a> and working only with it.
Top N rank check calculates the Jacquard distance between the current and previous sets of top N metric and checks if
it does not exceed the threshold value.</p>
<blockquote>
<p><strong>IMPORTANT</strong>: Calculation of this check is currently supported only between the current and previous topN metric sets.</p>
</blockquote>
<p>Top N rank check is configured using following parameters:</p>
<ul>
<li><code>id</code> - <em>Required</em>. Check ID</li>
<li><code>description</code> - <em>Optional</em>. Description of the check.</li>
<li><code>metric</code> - <em>Required</em>. Metric ID which result is checked.</li>
<li><code>targetNumber</code> - <em>Required</em>. Number of records from the set of top N metric results that is considered. 
  This number should be less than or equal to number of collected top values in top N metric.</li>
<li><code>threshold</code> - <em>Required</em>. Maximum allowed Jacquard distance between current and previous sets of records from 
  top N metric result. Should be a number in interval <code>[0, 1]</code>.</li>
<li><code>metadata</code> - <em>Optional</em>. List of user-defined metadata parameters specific to this metric where each parameter
  is a string in format: <code>param.name=param.value</code>.</li>
</ul>
<h2 id="expression-checks">Expression Checks</h2>
<p>Expression checks represent a boolean expression referring to one or multiple metric results which evaluates to
<code>true</code> or <code>false</code>. Metrics must be referenced by their IDs.</p>
<p>Formula must be written using <a href="https://mustache.github.io/mustache.5.html">Mustache Template</a> notation, e.g.:
<code>{{ metric_1 }} + {{ metic_2 }}</code>.</p>
<p>There are following operations supported to build boolean expressions:</p>
<ul>
<li>Basic <code>+-*/</code> and exponentiation <code>^</code> math operations.</li>
<li>Grouping using parentheses.</li>
<li>Mathematical functions of single argument: 
  <code>abs</code>, <code>sqrt</code>, <code>floor</code>, <code>ceil</code>, <code>round</code> (rounds to the closest integer), <code>ln</code> (natural logarithm), <code>lg</code> (decimal logarithm), <code>exp</code>.</li>
<li>Mathematical functions of two arguments: <code>max</code> and <code>min</code>.</li>
<li>Logical operators: <code>&amp;&amp;</code> (and), <code>||</code> (or), <code>not</code>.</li>
<li>Comparison operators: <code>==</code>, <code>&lt;&gt;</code>, <code>&gt;=</code>, <code>&lt;=</code>, <code>&gt;</code>, <code>&lt;</code>.</li>
</ul>
<p>Expression checks are configured using following set of parameters:</p>
<ul>
<li><code>id</code> - <em>Required</em>. Check ID</li>
<li><code>description</code> - <em>Optional</em>. Description of the check.</li>
<li><code>formula</code> - <em>Required</em>. Check formula: boolean expression referring to metric results.</li>
<li><code>metadata</code> - <em>Optional</em>. List of user-defined metadata parameters specific to this check where each parameter
  is a string in format: <code>param.name=param.value</code>.</li>
</ul>
<blockquote>
<p><strong>IMPORTANT</strong>. When storing check result into DQ storage, then first metric ID referenced in formula is 
considered as a base metric. And latter metric IDs are considered as compare metrics.</p>
</blockquote>
<h2 id="checks-configuration-example">Checks Configuration Example</h2>
<p>As it is shown in the example below, checks are grouped into two subsections: <code>trend</code> and <code>snapshot</code>.
Then, checks of the same type are grouped within subsections named after the type of the checks. 
These subsections should contain a list of metrics configurations of the corresponding type.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1">jobConfig: {
</span><span id="__span-0-2">  checks: {
</span><span id="__span-0-3">    trend: {
</span><span id="__span-0-4">      averageBoundFull: [
</span><span id="__span-0-5">        {
</span><span id="__span-0-6">          id: "avg_bal_check",
</span><span id="__span-0-7">          description: "Check that average balance stays within +/-25% of the week average"
</span><span id="__span-0-8">          metric: "avro_file1_avg_bal",
</span><span id="__span-0-9">          rule: "datetime"
</span><span id="__span-0-10">          windowSize: "8d"
</span><span id="__span-0-11">          threshold: 0.25
</span><span id="__span-0-12">          metadata: [
</span><span id="__span-0-13">            "requestor=some.person@some.domain",
</span><span id="__span-0-14">            "critical.check=true"
</span><span id="__span-0-15">          ]
</span><span id="__span-0-16">        }
</span><span id="__span-0-17">      ]
</span><span id="__span-0-18">      averageBoundUpper: [
</span><span id="__span-0-19">        {id: "avg_pct_null", metric: "pct_of_null", rule: "datetime", windowSize: "15d", threshold: 0.5}
</span><span id="__span-0-20">      ]
</span><span id="__span-0-21">      averageBoundLower: [
</span><span id="__span-0-22">        {id: "avg_distinct", metric: "fixed_file_dist_name", rule: "record", windowSize: 31, threshold: 0.3}
</span><span id="__span-0-23">      ]
</span><span id="__span-0-24">      averageBoundRange: [
</span><span id="__span-0-25">        {
</span><span id="__span-0-26">          id: "avg_inn_match",
</span><span id="__span-0-27">          metric: "table_source1_inn_regex",
</span><span id="__span-0-28">          rule: "datetime",
</span><span id="__span-0-29">          windowSize: "8d",
</span><span id="__span-0-30">          thresholdLower: 0.2
</span><span id="__span-0-31">          thresholdUpper: 0.4
</span><span id="__span-0-32">        }
</span><span id="__span-0-33">      ]
</span><span id="__span-0-34">      topNRank: [
</span><span id="__span-0-35">        {id: "top2_curr_match", metric: "filterVS_top3_currency", targetNumber: 2, threshold: 0.1}
</span><span id="__span-0-36">      ]
</span><span id="__span-0-37">    }
</span><span id="__span-0-38">    snapshot: {
</span><span id="__span-0-39">      differByLT: [
</span><span id="__span-0-40">        {
</span><span id="__span-0-41">          id: "row_cnt_diff",
</span><span id="__span-0-42">          description: "Number of rows in two tables should not differ on more than 5%.",
</span><span id="__span-0-43">          metric: "hive_table_row_cnt"
</span><span id="__span-0-44">          compareMetric: "csv_file_row_cnt"
</span><span id="__span-0-45">          threshold: 0.05
</span><span id="__span-0-46">        }
</span><span id="__span-0-47">      ]
</span><span id="__span-0-48">      equalTo: [
</span><span id="__span-0-49">        {id: "zero_nulls", description: "Hive Table1 mustn't contain nulls", metric: "hive_table_nulls", threshold: 0}
</span><span id="__span-0-50">      ]
</span><span id="__span-0-51">      greaterThan: [
</span><span id="__span-0-52">        {id: "completeness_check", metric: "orc_data_compl", threshold: 0.99}
</span><span id="__span-0-53">      ]
</span><span id="__span-0-54">      lessThan: [
</span><span id="__span-0-55">        {id: "null_threshold", metric: "pct_of_null", threshold: 0.01}
</span><span id="__span-0-56">      ]
</span><span id="__span-0-57">    }
</span><span id="__span-0-58">    expression: [
</span><span id="__span-0-59">      {
</span><span id="__span-0-60">        id: "row_cnt_diff_abs"
</span><span id="__span-0-61">        description: "Number of rows in two tables should not differ on more than 100 rows."
</span><span id="__span-0-62">        formula: "abs({{ hive_table_row_cnt }} - {{ csv_file_row_cnt }}) &lt;= 100"
</span><span id="__span-0-63">      }
</span><span id="__span-0-64">    ]
</span><span id="__span-0-65">  }
</span><span id="__span-0-66">}
</span></code></pre></div>
</article>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy", "navigation.tabs", "navigation.tabs.sticky", "navigation.indexes", "toc.follow", "toc.integrate"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
<script src="../../assets/javascripts/bundle.ad660dcc.min.js"></script>
<script>document$.subscribe(() => {
            window.update_swagger_ui_iframe_height = function (id) {
                var iFrameID = document.getElementById(id);
                if (iFrameID) {
                    full_height = (iFrameID.contentWindow.document.body.scrollHeight + 80) + "px";
                    iFrameID.height = full_height;
                    iFrameID.style.height = full_height;
                }
            }
        
            let iframe_id_list = []
            var iframes = document.getElementsByClassName("swagger-ui-iframe");
            for (var i = 0; i < iframes.length; i++) { 
                iframe_id_list.push(iframes[i].getAttribute("id"))
            }
        
            let ticking = true;
            
            document.addEventListener('scroll', function(e) {
                if (!ticking) {
                    window.requestAnimationFrame(()=> {
                        let half_vh = window.innerHeight/2;
                        for(var i = 0; i < iframe_id_list.length; i++) {
                            let element = document.getElementById(iframe_id_list[i])
                            if(element==null){
                                return
                            }
                            let diff = element.getBoundingClientRect().top
                            if(element.contentWindow.update_top_val){
                                element.contentWindow.update_top_val(half_vh - diff)
                            }
                        }
                        ticking = false;
                    });
                    ticking = true;
                }
            });
        
            const dark_scheme_name = "slate"
            
            window.scheme = document.body.getAttribute("data-md-color-scheme")
            const options = {
                attributeFilter: ['data-md-color-scheme'],
            };
            function color_scheme_callback(mutations) {
                for (let mutation of mutations) {
                    if (mutation.attributeName === "data-md-color-scheme") {
                        scheme = document.body.getAttribute("data-md-color-scheme")
                        var iframe_list = document.getElementsByClassName("swagger-ui-iframe")
                        for(var i = 0; i < iframe_list.length; i++) {
                            var ele = iframe_list.item(i);
                            if (ele) {
                                if (scheme === dark_scheme_name) {
                                    ele.contentWindow.enable_dark_mode();
                                } else {
                                    ele.contentWindow.disable_dark_mode();
                                }
                            }
                        }
                    }
                }
            }
            observer = new MutationObserver(color_scheme_callback);
            observer.observe(document.body, options);
            })</script></body>
</html>