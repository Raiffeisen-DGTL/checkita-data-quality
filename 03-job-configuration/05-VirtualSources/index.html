
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="https://raiffeisen-dgtl.github.io/checkita-data-quality/03-job-configuration/05-VirtualSources/" rel="canonical"/>
<link href="../04-Streams/" rel="prev"/>
<link href="../06-VirtualStreams/" rel="next"/>
<link href="../../logo/favicon.png" rel="icon"/>
<meta content="mkdocs-1.6.0, mkdocs-material-9.5.27" name="generator"/>
<title>Virtual Sources Configuration - Checkita Data Quality</title>
<link href="../../assets/stylesheets/main.6543a935.min.css" rel="stylesheet"/>
<link href="../../assets/stylesheets/palette.06af60db.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
</head>
<body data-md-color-accent="indigo" data-md-color-primary="yellow" data-md-color-scheme="slate" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#virtual-sources-configuration">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="Checkita Data Quality" class="md-header__button md-logo" data-md-component="logo" href="../.." title="Checkita Data Quality">
<img alt="logo" src="../../logo/logo.png"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            Checkita Data Quality
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Virtual Sources Configuration
            
          </span>
</div>
</div>
</div>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="" tabindex="0">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/Raiffeisen-DGTL/checkita-data-quality" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    checkita-data-quality
  </div>
</a>
</div>
</nav>
<nav aria-label="Tabs" class="md-tabs" data-md-component="tabs">
<div class="md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="../..">
        
  
    
  
  Home

      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../01-application-setup/">
          
  
    
  
  Application Setup

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../02-general-information/">
          
  
    
  
  General Information

        </a>
</li>
<li class="md-tabs__item md-tabs__item--active">
<a class="md-tabs__link" href="../">
          
  
    
  
  Job Configuration

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../changelog/CHANGELOG/">
        
  
    
  
  Changelog

      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../contribution/">
          
  
    
  
  Contribution

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../api/">
        
  
    
  
  Scala API Doc

      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../swagger/">
        
  
    
  
  Swagger Doc

      </a>
</li>
</ul>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Checkita Data Quality" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="Checkita Data Quality">
<img alt="logo" src="../../logo/logo.png"/>
</a>
    Checkita Data Quality
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/Raiffeisen-DGTL/checkita-data-quality" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    checkita-data-quality
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../..">
<span class="md-ellipsis">
    Home
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../01-application-setup/">
<span class="md-ellipsis">
    Application Setup
  </span>
</a>
<label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
            Application Setup
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../01-application-setup/01-ApplicationSettings/">
<span class="md-ellipsis">
    Application Settings
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../01-application-setup/02-ApplicationSubmit/">
<span class="md-ellipsis">
    Submitting Data Quality Application
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../01-application-setup/03-ResultsStorage/">
<span class="md-ellipsis">
    Data Quality Results Storage
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../02-general-information/">
<span class="md-ellipsis">
    General Information
  </span>
</a>
<label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_3_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
            General Information
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../02-general-information/01-WorkingWithDateTime/">
<span class="md-ellipsis">
    Working with Date and Time
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../02-general-information/02-EnvironmentAndExtraVariables/">
<span class="md-ellipsis">
    Usage of Environment Variables and Extra Variables
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../02-general-information/03-StatusModel/">
<span class="md-ellipsis">
    Status Model used in Results
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../02-general-information/04-ErrorCollection/">
<span class="md-ellipsis">
    Metric Error Collection
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../02-general-information/05-StreamingMode/">
<span class="md-ellipsis">
    Data Quality Checks over Streaming Sources
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../02-general-information/06-MetricSQLEquivalency/">
<span class="md-ellipsis">
    Metrics SQL Equivalency
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../02-general-information/07-MetricCalculatorEngines/">
<span class="md-ellipsis">
    Metric Calculator Engines Overview and Benchmarking
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_4" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../">
<span class="md-ellipsis">
    Job Configuration
  </span>
</a>
<label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="true" aria-labelledby="__nav_4_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
            Job Configuration
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../01-Connections/">
<span class="md-ellipsis">
    Connections Configuration
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../02-Schemas/">
<span class="md-ellipsis">
    Schemas Configuration
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../03-Sources/">
<span class="md-ellipsis">
    Sources Configuration
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../04-Streams/">
<span class="md-ellipsis">
    Streaming Sources Configurations
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
    Virtual Sources Configuration
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
<span class="md-ellipsis">
    Virtual Sources Configuration
  </span>
</a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#sql-virtual-source-configuration">
<span class="md-ellipsis">
      SQL Virtual Source Configuration
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#join-virtual-source-configuration">
<span class="md-ellipsis">
      Join Virtual Source Configuration
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#filter-virtual-source-configuration">
<span class="md-ellipsis">
      Filter Virtual Source Configuration
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#select-virtual-source-configuration">
<span class="md-ellipsis">
      Select Virtual Source Configuration
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#aggregate-virtual-source-configuration">
<span class="md-ellipsis">
      Aggregate Virtual Source Configuration
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#virtual-sources-configuration-example">
<span class="md-ellipsis">
      Virtual Sources Configuration Example
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../06-VirtualStreams/">
<span class="md-ellipsis">
    Virtual Streaming Sources Configuration
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../07-LoadChecks/">
<span class="md-ellipsis">
    Load Checks Configuration
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../08-Metrics/">
<span class="md-ellipsis">
    Metrics Configuration
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../09-Checks/">
<span class="md-ellipsis">
    Checks Configurations
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../10-Targets/">
<span class="md-ellipsis">
    Targets Configuration
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../11-FileOutputs/">
<span class="md-ellipsis">
    File Output Configuration
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../12-JobConfigExample/">
<span class="md-ellipsis">
    Job Configuration Example
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../changelog/CHANGELOG/">
<span class="md-ellipsis">
    Changelog
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_6" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../contribution/">
<span class="md-ellipsis">
    Contribution
  </span>
</a>
<label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_6_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_6">
<span class="md-nav__icon md-icon"></span>
            Contribution
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../contribution/code-of-conduct/">
<span class="md-ellipsis">
    Code of Conduct
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../contribution/contribution/">
<span class="md-ellipsis">
    Contribution Guide
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../api/">
<span class="md-ellipsis">
    Scala API Doc
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../swagger/">
<span class="md-ellipsis">
    Swagger Doc
  </span>
</a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1 id="virtual-sources-configuration">Virtual Sources Configuration</h1>
<p>Checkita framework supports creation of virtual (temporary) sources based on regular once (defined in <code>sources</code> section
of job configuration, as described in <a href="../03-Sources/">Sources Configuration</a> chapter). Virtual sources are created by
applying transformations to existing sources using Spark SQL API. Subsequently, metrics and checks can also be applied
to virtual sources.</p>
<p>It is also important to note, that virtual sources are created recursively, therefore, once virtual source is created
it can be used to create another one in the same way as regular sources. The order in which virtual sources are defined 
in job configuration file is not important. On the contrary, virtual sources are read in the order that correspond 
to their dependencies on parent sources.</p>
<p>The following types of virtual sources are supported:</p>
<ul>
<li><code>SQL</code>: enables creation of virtual source from existing once using arbitrary SQL query.</li>
<li><code>Join</code>: creates virtual source by joining two (and only 2) existing sources.</li>
<li><code>Filter</code>: creates virtual source from existing one by applying filter expression.</li>
<li><code>Select</code>: creates virtual source from existing one by applying select expression.</li>
<li><code>Aggregate</code>: creates virtual source by applying groupBy and aggregate operations to existing one.</li>
</ul>
<p>All types of virtual sources have common features:</p>
<ul>
<li>It is possible to cache virtual sources in memory or on disk. This could be handful when virtual sources is used as
  parent for more than one virtual source. In such cases caching virtual source allows not to calculate it multiple times.</li>
<li>Virtual source can be saved as a file in one of the supported format. This feature can be used for debugging purposes
  or just to keep data transformations applied during quality checks.</li>
</ul>
<p>Thus, virtual sources are defined in <code>virtualSources</code> section of job configuration and have following common parameters:</p>
<ul>
<li><code>id</code> - <em>Required</em>. Virtual source ID;</li>
<li><code>description</code> - <em>Optional</em>. Virtual source description;</li>
<li><code>parentSources</code> - <em>Required</em>. List of parent sources to use for creation of virtual sources. There could be a
  limitations imposed in number of parent sources, depending on virtual source type.</li>
<li><code>persist</code> - <em>Optional</em>. One of the allowed Spark StorageLevels used to cache virtual sources. By default, virtual
  sources are not cached. Supported Spark StorageLevels are:<ul>
<li><code>NONE</code>, <code>DISK_ONLY</code>, <code>DISK_ONLY_2</code>, <code>MEMORY_ONLY</code>, <code>MEMORY_ONLY_2</code>, <code>MEMORY_ONLY_SER</code>,
  <code>MEMORY_ONLY_SER_2</code>, <code>MEMORY_AND_DISK</code>, <code>MEMORY_AND_DISK_2</code>, <code>MEMORY_AND_DISK_SER</code>,
  <code>MEMORY_AND_DISK_SER_2</code>, <code>OFF_HEAP</code>.</li>
</ul>
</li>
<li><code>save</code> - <em>Optional</em>. File output configuration used to save virtual source. By default, virtual sources are not saved.
  For more information on configuring file outputs, see <a href="../11-FileOutputs/">File Output Configuration</a> chapter.</li>
<li><code>keyFields</code> - <em>Optional</em>. List of columns that form a Primary Key or are used to identify row within a dataset.
  Key fields are primarily used in error collection reports. For more details on error collection, see
  <a href="../../02-general-information/04-ErrorCollection/">Metric Error Collection</a> chapter.</li>
<li><code>metadata</code> - <em>Optional</em>. List of user-defined metadata parameters specific to this virtual source where each parameter
  is a string in format: <code>param.name=param.value</code>.</li>
</ul>
<h2 id="sql-virtual-source-configuration">SQL Virtual Source Configuration</h2>
<p><code>SQL</code> type of virtual sources is allowed only when <code>allowSqlQueries</code> is set to true. Otherwise, any usage of arbitrary
SQL queries will not be permitted. See <a href="../../01-application-setup/01-ApplicationSettings/#enablers">Enablers</a> chapter
for more information. At the same time, there is no limitation on number of parent sources used to create 
SQL virtual source.</p>
<p>In order to define SQL virtual source, it is required to provide an SQL query:</p>
<ul>
<li><code>kind: "sql"</code> - <em>Required</em>. Sets <code>SQL</code> virtual source type.</li>
<li><code>query</code> - <em>Required</em>. SQL query to build virtual source. <em>Existing sources are referred in SQL query by their IDs.</em></li>
</ul>
<h2 id="join-virtual-source-configuration">Join Virtual Source Configuration</h2>
<p>In order to define <code>Join</code> type of virtual sources, it is required to provided two <em>(and only two)</em> parent sources 
that are being joined as well as type of the join to use and list of column to join by. Note, that in order to 
perform join, parent sources should have matching column names to join by. Join by condition is not currently supported:</p>
<ul>
<li><code>kind: "join"</code> - <em>Required</em>. Sets <code>Join</code> virtual source type.</li>
<li><code>joinBy</code> - <em>Required</em>. List of columns to join by. Thus, parent sources must have the same columns names used for join.</li>
<li><code>joinType</code> - <em>Required</em>. Type of Spark join to apply. Following join types are supported:<ul>
<li><code>inner</code>, <code>outer</code>, <code>cross</code>, <code>full</code>, <code>right</code>, <code>left</code>, <code>semi</code>, <code>anti</code>, 
  <code>fullOuter</code>,  <code>rightOuter</code>, <code>leftOuter</code>, <code>leftSemi</code>, <code>leftAnti</code></li>
</ul>
</li>
</ul>
<h2 id="filter-virtual-source-configuration">Filter Virtual Source Configuration</h2>
<p><code>Filter</code> virtual source is defined by applying sequence of filter expressions to parent source. Thus, only one parent
source must be supplied to this type of virtual source configuration:</p>
<ul>
<li><code>kind: "filter"</code> - <em>Required</em>. Sets <code>Filter</code> virtual source type.</li>
<li><code>expr</code> - <em>Required</em>. Sequence of filter SQL expressions applied to parent source.</li>
</ul>
<h2 id="select-virtual-source-configuration">Select Virtual Source Configuration</h2>
<p><code>Select</code> virtual source is defined by applying sequence of select expression to parent source. Each select expression 
should yield a new column. Thus, the number of columns in the virtual source correspond to number of provided select
expressions. Subsequently, only one parent source must be supplied to this type of virtual source configuration:</p>
<ul>
<li><code>kind: "select"</code> - <em>Required</em>. Sets <code>Select</code> virtual source type.</li>
<li><code>expr</code> - <em>Required</em>. Sequence of select SQL expressions applied to parent source.</li>
</ul>
<h2 id="aggregate-virtual-source-configuration">Aggregate Virtual Source Configuration</h2>
<p><code>Aggregate</code> virtual source is defined by applying groupBy and aggregate operations to parent source. Thus, it is 
required to provide a list of columns used to group rows as well as list of aggregate operations in form of SQL 
expressions used to create columns with aggregated results. Thus, the number of columns in the virtual source 
correspond to number of provided aggregate expressions. Subsequently, only one parent source must be supplied 
to this type of virtual source configuration:</p>
<ul>
<li><code>kind: "aggregate"</code> - <em>Required</em>. Sets <code>Aggregate</code> virtual source type.</li>
<li><code>groupBy</code> - <em>Required</em>. Sequence of columns used to group rows from parent source.</li>
<li><code>expr</code> - <em>Required</em>. Sequence of SQL expressions used to get columns with aggregated results. </li>
</ul>
<h2 id="virtual-sources-configuration-example">Virtual Sources Configuration Example</h2>
<p>As it is shown in the example below, <code>virtualSources</code> section represent a list of virtual source definitions
of various kinds.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1">jobConfig: {
</span><span id="__span-0-2">  virtualSources: [
</span><span id="__span-0-3">    {
</span><span id="__span-0-4">      id: "sqlVS"
</span><span id="__span-0-5">      kind: "sql"
</span><span id="__span-0-6">      description: "Filter data for specific date only"
</span><span id="__span-0-7">      parentSources: ["hive_source_1"]
</span><span id="__span-0-8">      persist: "disk_only"
</span><span id="__span-0-9">      save: {
</span><span id="__span-0-10">        kind: "orc"
</span><span id="__span-0-11">        path: "some/path/to/vs/location"
</span><span id="__span-0-12">      }
</span><span id="__span-0-13">      query: "select id, name, entity, description from hive_source_1 where load_date == '2023-06-30'"
</span><span id="__span-0-14">      metadata: [
</span><span id="__span-0-15">        "source.owner=some.preson@some.domain"
</span><span id="__span-0-16">        "critical.source=false"
</span><span id="__span-0-17">      ]
</span><span id="__span-0-18">    }
</span><span id="__span-0-19">    {
</span><span id="__span-0-20">      id: "joinVS"
</span><span id="__span-0-21">      kind: "join"
</span><span id="__span-0-22">      parentSources: ["hdfs_avro_source", "hdfs_orc_source"]
</span><span id="__span-0-23">      joinBy: ["id"]
</span><span id="__span-0-24">      joinType: "leftouter"
</span><span id="__span-0-25">      persist: "memory_only"
</span><span id="__span-0-26">      keyFields: ["id", "order_id"]
</span><span id="__span-0-27">    }
</span><span id="__span-0-28">    {
</span><span id="__span-0-29">      id: "filterVS"
</span><span id="__span-0-30">      kind: "filter"
</span><span id="__span-0-31">      parentSources: ["kafka_source"]
</span><span id="__span-0-32">      expr: ["key is not null"]
</span><span id="__span-0-33">      keyFields: ["orderId", "dttm"]
</span><span id="__span-0-34">    }
</span><span id="__span-0-35">    {
</span><span id="__span-0-36">      id: "selectVS"
</span><span id="__span-0-37">      kind: "select"
</span><span id="__span-0-38">      parentSources: ["table_source_1"]
</span><span id="__span-0-39">      expr: [
</span><span id="__span-0-40">        "count(id) as id_cnt",
</span><span id="__span-0-41">        "sum(amount) as total_amount"
</span><span id="__span-0-42">      ]
</span><span id="__span-0-43">    }
</span><span id="__span-0-44">    {
</span><span id="__span-0-45">      id: "aggVS"
</span><span id="__span-0-46">      kind: "aggregate"
</span><span id="__span-0-47">      parentSources: ["hdfs_fixed_file"]
</span><span id="__span-0-48">      groupBy: ["col1"]
</span><span id="__span-0-49">      expr: [
</span><span id="__span-0-50">        "avg(col2) as avg_col2",
</span><span id="__span-0-51">        "sum(col3) as sum_col3"
</span><span id="__span-0-52">      ],
</span><span id="__span-0-53">      keyFields: ["col1", "avg_col2", "sum_col3"]
</span><span id="__span-0-54">    }
</span><span id="__span-0-55">  ]
</span><span id="__span-0-56">}
</span></code></pre></div>
</article>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy", "navigation.tabs", "navigation.tabs.sticky", "navigation.indexes", "toc.follow", "toc.integrate"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
<script src="../../assets/javascripts/bundle.ad660dcc.min.js"></script>
<script>document$.subscribe(() => {
            window.update_swagger_ui_iframe_height = function (id) {
                var iFrameID = document.getElementById(id);
                if (iFrameID) {
                    full_height = (iFrameID.contentWindow.document.body.scrollHeight + 80) + "px";
                    iFrameID.height = full_height;
                    iFrameID.style.height = full_height;
                }
            }
        
            let iframe_id_list = []
            var iframes = document.getElementsByClassName("swagger-ui-iframe");
            for (var i = 0; i < iframes.length; i++) { 
                iframe_id_list.push(iframes[i].getAttribute("id"))
            }
        
            let ticking = true;
            
            document.addEventListener('scroll', function(e) {
                if (!ticking) {
                    window.requestAnimationFrame(()=> {
                        let half_vh = window.innerHeight/2;
                        for(var i = 0; i < iframe_id_list.length; i++) {
                            let element = document.getElementById(iframe_id_list[i])
                            if(element==null){
                                return
                            }
                            let diff = element.getBoundingClientRect().top
                            if(element.contentWindow.update_top_val){
                                element.contentWindow.update_top_val(half_vh - diff)
                            }
                        }
                        ticking = false;
                    });
                    ticking = true;
                }
            });
        
            const dark_scheme_name = "slate"
            
            window.scheme = document.body.getAttribute("data-md-color-scheme")
            const options = {
                attributeFilter: ['data-md-color-scheme'],
            };
            function color_scheme_callback(mutations) {
                for (let mutation of mutations) {
                    if (mutation.attributeName === "data-md-color-scheme") {
                        scheme = document.body.getAttribute("data-md-color-scheme")
                        var iframe_list = document.getElementsByClassName("swagger-ui-iframe")
                        for(var i = 0; i < iframe_list.length; i++) {
                            var ele = iframe_list.item(i);
                            if (ele) {
                                if (scheme === dark_scheme_name) {
                                    ele.contentWindow.enable_dark_mode();
                                } else {
                                    ele.contentWindow.disable_dark_mode();
                                }
                            }
                        }
                    }
                }
            }
            observer = new MutationObserver(color_scheme_callback);
            observer.observe(document.body, options);
            })</script></body>
</html>