# Сбор Ошибок Вычисления Метрик

Вычисление метрик включает в себя процесс чтения данных источника строка за строкой и приращение значения метрики
для каждой строки (в случае, если условие метрики выполнено). Так, во время вычисления значения приращения метрики для
текущей строки что-то может пойти не так: могут быть какие-либо проблемы с данными или ошибки исполнения. В дополнение,
многие метрики имеют логическое условие которое должно быть выполнено, чтобы значение метрики было изменено. Если это
условие не выполняется, то вычисление приращения для текущей строки также рассматривается как не выполненное.

Таким образом, в вышеописанных ситуациях будет задействован механизм сборка ошибок вычисления метрик и следующая
информация об ошибке будет записана:

* Информация о самой метрике: ее ID и список колонок, по которым вычисляется метрика.
* Информация об источнике, над которым выполняется расчет метрики: его ID и список колонок-ключей.
* Информация об ошибке: статус (либо `Failure`, либо `Error`) и сообщение с описанием ошибки.
* Выборка данных из строки источника, где случилась ошибка: записываются только значения из колонок-ключей источника и 
  колонок, по которым считается метрика.

Поскольку источники данных, над которыми выполняются расчеты, могут быть очень большим, и, как следствие, могут
производить значительное число ошибок во время вычисления метрик, то существует риск переполнения памяти во время
записи информации об этих ошибках. Для того чтобы это предотвратить, количество ошибок, которое может быть собрано для
каждой метрики, ограничено на уровне 10000 ошибок. В случае необходимости это число можно уменьшить, установив
соответсвующее ограничение в файле с настройками приложения в поле `errorDumpSize`. 
См. главу [Активаторы](../01-application-setup/01-ApplicationSettings.md#_3).

Собранные ошибки по вычислению метрик могут быть использованы, чтобы находить и исправлять проблемы в данных. Для того
чтобы получить эти ошибки, необходимо настроить сохранение соответствующих отчетов по завершении работы пайплайна. 
Запрос на сбор отчетов об ошибках выполняется разделе `targets` файла с конфигурациями Data Quality пайплайна, как это
описано в главе [Отчеты об ошибках](???). Стоит также заметить, что отчеты будут содержать выборки данных из источников, 
поэтому следует внимательно относиться к тому, кто будет иметь доступ к этим отчетам. По этим же соображениям, отчеты об
ошибках не сохраняются в хранилище результатов фреймворка.
