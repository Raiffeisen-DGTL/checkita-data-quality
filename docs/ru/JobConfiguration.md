# Job Configuration

Для описания источников данных, метрик для расчета, а также проверок, которые необходимо выполнить,
**Checkita** использует конфигурационный файл, который составляется в формате
[Hocon](https://github.com/lightbend/config/blob/main/HOCON.md).

Каждый конфигурационный файл должен начинаться с указания `jobId`, который объединяет расчеты метрик над источниками в
рамках одной схемы, витрины или другого логического формирования данных. Все идентификаторы источников, метрик
и проверок (и др.) должны быть уникальны в рамках одного jobId.

```hocon
jobId: "inc5000_companies"
```

> **Важно!** При запуске расчета формируется временная версия конфигурационного файла, в которую добавляются следующие
> стандартные переменные:
>
> * `referenceDateTime`: дата, за которую выполняется расчет (задается в аргументах фреймворка при запуске
>   Spark-приложения, по умолчанию соответствует дате запуска приложения);
>   Формат строкового представления даты задается в `application.conf`
> * `executionDateTime`: Фактическая дата запуска приложения, формат строкового представления которой также задается в
>   `application.conf`
>
> Эти переменные могут быть использованы в дальнейшем при описании источников, метрик или проверок. Например, путь до
> данных может быть указан вот так:

```hocon
path: "/data/inc5000_companies/load_date="${referenceDateTime}
```

Конфигурационный файл состоит из следующих основных разделов, каждому из которых посвящена отдельная глава в документации:

* [Databases](./jobConfig/Databases.md): в данном разделе задаются параметры подключения к внешним БД.
* [Message Brokers](./jobConfig/MessageBrokers.md): в данном разделе задаются параметры подключения
  к брокерам очередей.
  > **Важно:** На данный момент поддерживается только **Kafka**.
* [Sources](./jobConfig/Sources.md): в данном разделе описываются источники данных, над которыми будут вычисляться
  метрики и выполняться проверки.
* [Virtual Sources](./jobConfig/VirtualSources.md): **Checkita** позволяет формировать виртуальные
  источники данных, на основе физических и выполнять расчеты непосредственно над ними. Такие источники описываются
  в этом разделе.
* [Metrics](./jobConfig/Metrics.md): основой раздел конфигурационного файла, где описываются метрики, которые
  необходимо рассчитать.
* [Checks](./jobConfig/Checks.md): данный раздел описывает проверки, которые необходимо выполнить после расчета метрик.
* [Targets](./jobConfig/Targets.md): Данный раздел позволяет указать, какие результаты расчета нужно сохранить и куда
  (помимо основной базы данных фреймворка), а также здесь можно настроить отправку уведомлений, в случае, если
  какие-либо проверки не были пройдены.

> **Важно!** Имена ключей в конфигурационном файле чувствительны к регистру и указываются в **camelCase**

Пример полностью заполненного конфигурационного файла можно найти [тут](../examples/jobConfig.conf).